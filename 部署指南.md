# 🚀 播客生成 Demo 部署指南

## 📋 部署方案概览

| 方案 | 难度 | 成本 | 适用场景 | 推荐指数 |
|------|------|------|----------|----------|
| 本地部署 | ⭐ | 免费 | 个人使用、演示 | ⭐⭐⭐⭐⭐ |
| Vercel 部署 | ⭐⭐ | 免费 | 小型项目、演示 | ⭐⭐⭐⭐ |
| 云服务器部署 | ⭐⭐⭐ | 付费 | 生产环境、团队使用 | ⭐⭐⭐ |
| Docker 部署 | ⭐⭐⭐⭐ | 付费 | 企业级、容器化 | ⭐⭐⭐ |

---

## 🏠 方案一：本地部署（推荐新手）

### 环境要求
- macOS 系统
- Node.js 18.0+
- FFmpeg 7.0+

### 快速部署步骤

1. **下载项目**
   ```bash
   # 将 播客生成Demo完整版 文件夹复制到本地
   cd 播客生成Demo完整版
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **安装 FFmpeg**
   ```bash
   brew install ffmpeg
   ```

4. **配置环境变量**
   ```bash
   # 复制配置文件
   cp config.example.sh config.sh
   
   # 编辑配置文件，填入你的 API 密钥
   nano config.sh
   ```

5. **一键启动**
   ```bash
   ./start.sh
   ```

6. **访问应用**
   - 打开浏览器访问：`http://localhost:3000`
   - 或直接打开 `demo.html` 文件

### 优势
- ✅ 完全免费
- ✅ 部署简单
- ✅ 调试方便
- ✅ 数据安全

### 劣势
- ❌ 只能本地访问
- ❌ 需要本地环境配置

---

## ☁️ 方案二：Vercel 部署（推荐演示）

### 环境要求
- GitHub 账号
- Vercel 账号（免费）

### 部署步骤

1. **准备项目**
   ```bash
   # 创建 vercel.json 配置文件
   ```

2. **上传到 GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin https://github.com/你的用户名/播客demo.git
   git push -u origin main
   ```

3. **Vercel 部署**
   - 登录 [Vercel](https://vercel.com)
   - 点击 "New Project"
   - 导入 GitHub 仓库
   - 配置环境变量
   - 部署

4. **配置环境变量**
   ```
   MINIMAX_API_KEY=你的API密钥
   GROUP_ID=你的Group ID
   ```

### 优势
- ✅ 免费额度充足
- ✅ 自动 HTTPS
- ✅ 全球 CDN
- ✅ 自动部署

### 劣势
- ❌ 需要配置环境变量
- ❌ 某些功能可能受限

---

## 🖥️ 方案三：云服务器部署（推荐生产）

### 推荐平台
- **阿里云 ECS**：国内访问快
- **腾讯云 CVM**：性价比高
- **AWS EC2**：功能强大
- **DigitalOcean**：简单易用

### 部署步骤（以阿里云为例）

1. **购买服务器**
   - 选择 Ubuntu 20.04 或 CentOS 8
   - 配置：2核4G 起步
   - 带宽：5Mbps 起步

2. **连接服务器**
   ```bash
   ssh root@你的服务器IP
   ```

3. **安装环境**
   ```bash
   # 更新系统
   apt update && apt upgrade -y
   
   # 安装 Node.js
   curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
   apt-get install -y nodejs
   
   # 安装 FFmpeg
   apt install ffmpeg -y
   
   # 安装 Git
   apt install git -y
   ```

4. **部署项目**
   ```bash
   # 克隆项目
   git clone https://github.com/你的用户名/播客demo.git
   cd 播客demo
   
   # 安装依赖
   npm install
   
   # 配置环境变量
   nano .env
   ```

5. **配置环境变量**
   ```bash
   # 创建 .env 文件
   MINIMAX_API_KEY=你的API密钥
   GROUP_ID=你的Group ID
   PORT=3000
   ```

6. **使用 PM2 管理进程**
   ```bash
   # 安装 PM2
   npm install -g pm2
   
   # 启动应用
   pm2 start integrated_server.js --name "播客demo"
   
   # 设置开机自启
   pm2 startup
   pm2 save
   ```

7. **配置 Nginx 反向代理**
   ```bash
   # 安装 Nginx
   apt install nginx -y
   
   # 配置 Nginx
   nano /etc/nginx/sites-available/播客demo
   ```

   ```nginx
   server {
       listen 80;
       server_name 你的域名或IP;
       
       location / {
           proxy_pass http://localhost:3000;
           proxy_http_version 1.1;
           proxy_set_header Upgrade $http_upgrade;
           proxy_set_header Connection 'upgrade';
           proxy_set_header Host $host;
           proxy_cache_bypass $http_upgrade;
       }
   }
   ```

   ```bash
   # 启用配置
   ln -s /etc/nginx/sites-available/播客demo /etc/nginx/sites-enabled/
   nginx -t
   systemctl restart nginx
   ```

8. **配置防火墙**
   ```bash
   ufw allow 22
   ufw allow 80
   ufw allow 443
   ufw enable
   ```

### 优势
- ✅ 完全控制
- ✅ 性能稳定
- ✅ 可扩展性强
- ✅ 支持自定义域名

### 劣势
- ❌ 需要付费
- ❌ 配置复杂
- ❌ 需要维护

---

## 🐳 方案四：Docker 部署（推荐企业）

### 环境要求
- Docker
- Docker Compose

### 部署步骤

1. **创建 Dockerfile**
   ```dockerfile
   FROM node:18-alpine
   
   WORKDIR /app
   
   COPY package*.json ./
   RUN npm install
   
   COPY . .
   
   EXPOSE 3000
   
   CMD ["node", "integrated_server.js"]
   ```

2. **创建 docker-compose.yml**
   ```yaml
   version: '3.8'
   services:
     podcast-demo:
       build: .
       ports:
         - "3000:3000"
       environment:
         - MINIMAX_API_KEY=${MINIMAX_API_KEY}
         - GROUP_ID=${GROUP_ID}
       volumes:
         - ./uploads:/app/uploads
         - ./outputs:/app/outputs
       restart: unless-stopped
   ```

3. **部署命令**
   ```bash
   # 构建镜像
   docker-compose build
   
   # 启动服务
   docker-compose up -d
   
   # 查看日志
   docker-compose logs -f
   ```

### 优势
- ✅ 环境一致
- ✅ 易于扩展
- ✅ 版本管理
- ✅ 快速部署

### 劣势
- ❌ 学习成本高
- ❌ 资源消耗大

---

## 🔧 通用配置说明

### 环境变量配置
```bash
# 必需配置
MINIMAX_API_KEY=你的Minimax API密钥
GROUP_ID=你的Minimax Group ID

# 可选配置
PORT=3000                    # 服务器端口
UPLOAD_LIMIT=10MB           # 文件上传限制
AUDIO_FORMAT=mp3            # 音频输出格式
AUDIO_BITRATE=128000        # 音频比特率
AUDIO_SAMPLE_RATE=32000     # 音频采样率
```

### 性能优化建议
1. **内存优化**：设置 Node.js 内存限制
   ```bash
   export NODE_OPTIONS="--max-old-space-size=2048"
   ```

2. **文件清理**：定期清理临时文件
   ```bash
   # 添加到 crontab
   0 2 * * * find /app/uploads -mtime +7 -delete
   0 2 * * * find /app/outputs -mtime +7 -delete
   ```

3. **日志管理**：配置日志轮转
   ```bash
   # 使用 PM2 日志管理
   pm2 install pm2-logrotate
   ```

### 安全配置
1. **HTTPS 配置**：使用 Let's Encrypt
2. **防火墙配置**：只开放必要端口
3. **API 密钥保护**：使用环境变量
4. **文件上传限制**：设置大小和类型限制

---

## 🚨 常见问题解决

### 1. 端口被占用
```bash
# 查看端口占用
lsof -i :3000

# 杀死进程
kill -9 进程ID
```

### 2. 权限问题
```bash
# 修改文件权限
chmod +x start.sh
chmod 755 uploads/
chmod 755 outputs/
```

### 3. 内存不足
```bash
# 增加 swap 空间
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

### 4. 网络问题
```bash
# 检查网络连接
ping api.minimaxi.com

# 检查 DNS 解析
nslookup api.minimaxi.com
```

---

## 📞 技术支持

### 获取帮助
1. 查看项目 README.md
2. 检查服务器日志
3. 查看常见问题
4. 提交 Issue

### 联系方式
- 项目地址：播客生成Demo完整版
- 技术支持：查看日志和文档
- 功能建议：提交 Issue

---

**选择建议**：
- **新手用户**：选择本地部署
- **演示项目**：选择 Vercel 部署
- **生产环境**：选择云服务器部署
- **企业用户**：选择 Docker 部署

**VIVID VOICE** - 让文字栩栩如"声" 🎙️
